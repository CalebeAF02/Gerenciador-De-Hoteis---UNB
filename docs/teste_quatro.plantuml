@startuml
skinparam linetype ortho
skinparam packageStyle rectangle
skinparam classAttributeIconSize 0

' Paleta de cores por pacote:
' - sistema:            #E3F2FD
' - pacote_acesso:      #FCE4EC
' - pacote_autenticavel:#E8F5E9
' - pacote_fabrica:     #FFF3E0
' - pacote_gerente:     #EDE7F6
' - pacote_hospede:     #F3E5F5
' - pacote_hotel:       #F9FBE7
' - pacote_quarto:      #E0F7FA
' - pacote_reserva:     #FFFDE7

' =========================================================================================
' SISTEMA
' =========================================================================================
package "sistema" #E3F2FD {
  namespace Hotelaria {
    class Sistema {
      - bool executando = true
      - ControladoraApresentacaoAcessoGerente contoladoraApresentacaoAcessoGerente
      - ControladoraApresentacaoAcessoHospede contoladoraApresentacaoAcessoHospede
      --
      - void exibirMenu()
      - bool getExecutandoSistema()
      - void sair()
      ++ void iniciar()
    }
  }
}

' =========================================================================================
' PACOTE ACESSO
' =========================================================================================
package "sub_sistema.pacote_acesso" #FCE4EC {
  namespace Hotelaria {
    interface InterfaceApresentacaoAcesso {
      + void exibirMenu()
      + void setControladoraServicoAcesso(InterfaceServicoAcesso *)
    }

    class InterfaceServicoAcesso {
      ' Interface vazia no momento
    }

    class ControladoraApresentacaoAcessoGerente {
      - InterfaceServicoAcesso * controladora_servico_acesso_gerente
      - ControladorInterfaceGerente controladorGerente
      --
      + void exibirMenu()
      + void setControladoraServicoAcesso(InterfaceServicoAcesso *)
      + void exibirMenuGerenciador()
    }

    class ControladoraApresentacaoAcessoHospede {
      - InterfaceServicoAcesso * controladora_servico_acesso_hospede
      --
      + void exibirMenu()
      + void setControladoraServicoAcesso(InterfaceServicoAcesso *)
      + void opcoesDeHospedagem()
      + void solicitandoHospedagem()
      + void statusDaSolicitandoHospedagem() const
    }
  }

  ' Serviços de acesso (sem namespace no arquivo)
  class ControladoraServicoAcessoGerente {
  }

  class ControladoraServicoAcessoHospede {
  }
}

' Relações de implementação e composição (pacote acesso)
Hotelaria.ControladoraApresentacaoAcessoGerente ..|> Hotelaria.InterfaceApresentacaoAcesso : "implementação"
Hotelaria.ControladoraApresentacaoAcessoHospede ..|> Hotelaria.InterfaceApresentacaoAcesso : "implementação"

Hotelaria.ControladoraApresentacaoAcessoGerente *-- Hotelaria.ControladorInterfaceGerente : "composição"
Hotelaria.ControladoraApresentacaoAcessoGerente *-- Hotelaria.InterfaceServicoAcesso : "composição"
Hotelaria.ControladoraApresentacaoAcessoHospede *-- Hotelaria.InterfaceServicoAcesso : "composição"

' =========================================================================================
' PACOTE AUTENTICÁVEL
' =========================================================================================
package "sub_sistema.pacote_autenticavel" #E8F5E9 {
  namespace Hotelaria {
    interface InterfaceApresentacaoAutenticavel {
      + void sair()
      + bool autenticar(Email *)
      + void setControladoraServicoAutenticavel(InterfaceServicoAutenticavel *)
      + void setEstaAutenticado(bool estaAutenticado)
      + bool getEstaAutenticado()
    }

    interface InterfaceServicoAutenticavel {
      + bool autenticar(const Email, const Senha)
    }

    class ControladoraApresentacaoAutenticavel {
      - InterfaceServicoAutenticavel * controladora_servico_autenticavel
      - bool estaAutenticado = false
      --
      + void sair()
      + bool autenticar(Email *)
      + void setControladoraServicoAutenticavel(InterfaceServicoAutenticavel *)
      + void setEstaAutenticado(bool estaAutenticado)
      + bool getEstaAutenticado()
      + InterfaceServicoAutenticavel * getHacke()
    }

    class ControladoraServicoAutenticavel {
      + bool autenticar(const Email, const Senha)
    }
  }
}

' Relações de implementação e composição (pacote autenticável)
Hotelaria.ControladoraApresentacaoAutenticavel ..|> Hotelaria.InterfaceApresentacaoAutenticavel : "implementação"
Hotelaria.ControladoraServicoAutenticavel ..|> Hotelaria.InterfaceServicoAutenticavel : "implementação"

Hotelaria.ControladoraApresentacaoAutenticavel *-- Hotelaria.InterfaceServicoAutenticavel : "composição"

' =========================================================================================
' PACOTE FÁBRICA
' =========================================================================================
package "sub_sistema.pacote_fabrica" #FFF3E0 {
  namespace Hotelaria {
    interface InterfaceFabricaGerenciavel {
      + unique_ptr<MenuCRUD> criar()
      + ~InterfaceFabricaGerenciavel()
    }

    class "FabricaGerenciavel<T>" as FabricaGerenciavel {
      + shared_ptr<T> criar()
      + void ler()
      + void atualizar()
      + void remover()
      + void executarMenu(string tituloStr, bool &executando)
    }
  }
}

' =========================================================================================
' PACOTE GERENTE
' =========================================================================================
package "sub_sistema.pacote_gerente" #EDE7F6 {
  namespace Hotelaria {
    interface InterfaceApresentacaoGerente {
      + void executar(const Email email)
      + void setControladoraServicoPessoal(InterfaceServicoGerente *)
    }

    interface InterfaceServicoGerente {
      + bool incluir(const Gerente)
      + bool remover(const Email email)
      + bool pesquisar(Gerente)
      + bool editar(const Gerente)
      + ~InterfaceServicoGerente()
    }

    class ControladoraApresentacaoGerente {
      - const static int INCLUIR = 1
      - const static int REMOVER = 2
      - const static int PESQUISAR = 3
      - const static int EDITAR = 4
      - const static int RETORNAR = 5
      - InterfaceServicoGerente * controladora_servico_pessoal
      --
      + void executar(const Email)
      + void setControladoraServicoPessoal(InterfaceServicoGerente *)
    }

    class ControladorInterfaceGerente {
      - PersistenciaGerente persistencia
      - bool executando = true
      - bool estaAutenticado = false
      --
      + ControladorInterfaceGerente()
      + void exibirMenuCRUD()
      + void criar()
      + void ler()
      + void atualizar()
      + void remover()
      ' herdado de ControladoraApresentacaoAutenticavel:
      + void sair()
      + bool autenticar(Email *)
      + void setControladoraServicoAutenticavel(InterfaceServicoAutenticavel *)
      + void setEstaAutenticado(bool estaAutenticado)
      + bool getEstaAutenticado()
      + InterfaceServicoAutenticavel * getHacke()
    }

    class PersistenciaGerente {
      + bool inserir(Gerente &gerente)
      + vector<GerenteDTO *> listar()
      + bool atualizar(int id, const Gerente &gerente)
      + bool excluirPorId(int id)
      + bool autenticarGerente(const string &email, const string &senha)
      + optional<GerenteDTO> buscaGerentePorID(int id)
    }

    class ControladoraServicoGerente {
      + bool incluir(const Gerente)
      + bool remover(const Email email)
      + bool pesquisar(Gerente)
      + bool editar(const Gerente)
    }
  }
}

' Relações de herança, implementação e composição (pacote gerente)
Hotelaria.ControladoraApresentacaoGerente ..|> Hotelaria.InterfaceApresentacaoGerente : "implementação"
Hotelaria.ControladoraServicoGerente ..|> Hotelaria.InterfaceServicoGerente : "implementação"

Hotelaria.ControladorInterfaceGerente --|> Hotelaria.ControladoraApresentacaoAutenticavel : "herança"
Hotelaria.ControladorInterfaceGerente *-- Hotelaria.PersistenciaGerente : "composição"

Hotelaria.ControladoraApresentacaoGerente *-- Hotelaria.InterfaceServicoGerente : "composição"

' =========================================================================================
' PACOTE HÓSPEDE
' =========================================================================================
package "sub_sistema.pacote_hospede" #F3E5F5 {
  namespace Hotelaria {
    interface InterfaceApresentacaoHospede {
      + bool valor()
      + void setControladoraServicoHospede(InterfaceServicoHospede *)
    }

    interface InterfaceServicoHospede {
      + bool valor()
    }

    class ControladoraApresentacaoHospede {
      - InterfaceServicoHospede * controladora_servico_hospede
      --
      + bool valor()
      + void setControladoraServicoHospede(InterfaceServicoHospede *)
    }

    class ControladorInterfaceHospede {
      - PersistenciaHospede persistencia
      - bool executando = true
      --
      + ControladorInterfaceHospede()
      + void avaliarSolicitacoes()
      + void exibirMenuCRUD()
      + void criar()
      + void ler()
      + void atualizar()
      + void remover()
    }

    class PersistenciaHospede {
      - string caminho = "Dados_Hospedes.txt"
      --
      + vector<Hospede *> listar()
      + bool criar(Hospede &gerente)
    }

    class PersistenciaSolicitacaoHospedagem {
      + static void inicializar()
      + static void salvar(const SolicitacaoHospedagem &s)
      + static vector<SolicitacaoHospedagem> buscarPorEmail(const string &email)
      + static vector<SolicitacaoHospedagem> buscarPorStatus(int status)
      + static void atualizar(const SolicitacaoHospedagem &s)
    }

    class ControladoraServicoHospede {
      ' InterfaceServicoHospede ainda não detalha a operação
    }
  }
}

' Relações de implementação e composição (pacote hóspede)
Hotelaria.ControladoraApresentacaoHospede ..|> Hotelaria.InterfaceApresentacaoHospede : "implementação"
Hotelaria.ControladoraServicoHospede ..|> Hotelaria.InterfaceServicoHospede : "implementação"

Hotelaria.ControladoraApresentacaoHospede *-- Hotelaria.InterfaceServicoHospede : "composição"
Hotelaria.ControladorInterfaceHospede *-- Hotelaria.PersistenciaHospede : "composição"

' =========================================================================================
' PACOTE HOTEL
' =========================================================================================
package "sub_sistema.pacote_hotel" #F9FBE7 {
  namespace Hotelaria {
    interface InterfaceApresentacaoHotel {
      + bool valor()
      + void setControladoraServicoHotel(InterfaceServicoHotel *)
    }

    interface InterfaceServicoHotel {
      + bool valor()
    }

    class ControladoraApresentacaoHotel {
      - InterfaceServicoHotel * controladora_servico_hotel
      --
      + bool valor()
      + void setControladoraServicoHotel(InterfaceServicoHotel *)
    }

    class ControladorInterfaceHotel {
      - PersistenciaHotel persistencia
      - bool executando = true
      --
      + ControladorInterfaceHotel()
      + void exibirMenu()
      + void exibirMenuCRUD()
      + void criar()
      + void ler()
      + void atualizar()
      + void remover()
    }

    class PersistenciaHotel {
      + bool inserir(Hotel *hotel)
      + vector<HotelDTO *> listar()
      + optional<HotelDTO> buscaHotelPorID(int id)
      + bool atualizar(int id, const Hotel &hotel)
    }

    class ControladoraServicoHotel {
      ' InterfaceServicoHotel ainda não detalha a operação
    }
  }
}

' Relações de implementação e composição (pacote hotel)
Hotelaria.ControladoraApresentacaoHotel ..|> Hotelaria.InterfaceApresentacaoHotel : "implementação"
Hotelaria.ControladoraServicoHotel ..|> Hotelaria.InterfaceServicoHotel : "implementação"

Hotelaria.ControladoraApresentacaoHotel *-- Hotelaria.InterfaceServicoHotel : "composição"
Hotelaria.ControladorInterfaceHotel *-- Hotelaria.PersistenciaHotel : "composição"

' =========================================================================================
' PACOTE QUARTO
' =========================================================================================
package "sub_sistema.pacote_quarto" #E0F7FA {
  namespace Hotelaria {
    interface InterfaceApresentacaoQuarto {
      + bool valor()
      + void setControladoraServicoQuarto(InterfaceServicoQuarto *)
    }

    interface InterfaceServicoQuarto {
      + bool valor()
    }

    class ControladoraApresentacaoQuarto {
      - InterfaceServicoQuarto * controladora_servico_quarto
      --
      + bool valor()
      + void setControladoraServicoQuarto(InterfaceServicoQuarto *)
    }

    class ControladorInterfaceQuarto {
      + ControladorInterfaceQuarto()
      + void exibirMenu()
      + void exibirMenuCRUD()
    }

    class ControladoraServicoQuarto {
      ' InterfaceServicoQuarto ainda não detalha a operação
    }
  }
}

' Relações de implementação e composição (pacote quarto)
Hotelaria.ControladoraApresentacaoQuarto ..|> Hotelaria.InterfaceApresentacaoQuarto : "implementação"
Hotelaria.ControladoraServicoQuarto ..|> Hotelaria.InterfaceServicoQuarto : "implementação"

Hotelaria.ControladoraApresentacaoQuarto *-- Hotelaria.InterfaceServicoQuarto : "composição"

' =========================================================================================
' PACOTE RESERVA
' =========================================================================================
package "sub_sistema.pacote_reserva" #FFFDE7 {
  namespace Hotelaria {
    interface InterfaceApresentacaoReserva {
      + bool valor()
      + void setControladoraServicoReserva(InterfaceServicoReserva *)
    }

    interface InterfaceServicoReserva {
      + bool valor()
    }

    class ControladoraApresentacaoReserva {
      - InterfaceServicoReserva * controladora_servico_reserva
      --
      + bool valor()
      + void setControladoraServicoReserva(InterfaceServicoReserva *)
      + void exibirMenu()
      + void exibirMenuCRUD()
    }

    class ControladorInterfaceReserva {
      + ControladorInterfaceReserva()
      + void exibirMenu()
      + void exibirMenuCRUD()
    }

    class ControladoraServicoReserva {
      ' InterfaceServicoReserva ainda não detalha a operação
    }
  }
}

' Relações de implementação e composição (pacote reserva)
Hotelaria.ControladoraApresentacaoReserva ..|> Hotelaria.InterfaceApresentacaoReserva : "implementação"
Hotelaria.ControladoraServicoReserva ..|> Hotelaria.InterfaceServicoReserva : "implementação"

Hotelaria.ControladoraApresentacaoReserva *-- Hotelaria.InterfaceServicoReserva : "composição"

' =========================================================================================
' RELAÇÕES ENTRE PACOTES/CLASSES CRUZADAS (APENAS AS EXISTENTES NO ARQUIVO)
' =========================================================================================

' Sistema usa controladoras de acesso
Hotelaria.Sistema *-- Hotelaria.ControladoraApresentacaoAcessoGerente : "composição"
Hotelaria.Sistema *-- Hotelaria.ControladoraApresentacaoAcessoHospede : "composição"

' ControladorInterfaceGerente configura serviço autenticável (dependência já coberta via herança+composição)
Hotelaria.ControladoraServicoAutenticavel ..> Hotelaria.PersistenciaGerente : "dependência"

' ControladorInterfaceHospede usa persistências de hospede e solicitação (composição/dependência)
Hotelaria.ControladorInterfaceHospede ..> Hotelaria.PersistenciaSolicitacaoHospedagem : "dependência"

@enduml
